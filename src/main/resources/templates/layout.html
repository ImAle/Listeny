<!doctype html>
<html lang="es_ES" xmlns:th="https://www.thymeleaf.org" xmlns:layout="https://www.ultraq.net.nz/thymeleaf/layout">
<head th:fragment="head">

  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <!-- Bootstrap CSS -->
  <link th:href="@{https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css}" rel="stylesheet"
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous"/>

  <!-- Estilos personalizados -->
  <link th:href="@{/css/custom.css}" type="text/css" rel="stylesheet"/>

  <!-- Bootstarp icons -->
  <link th:href="@{https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css}" rel="stylesheet"/>

  <!-- Font Awesome JS -->
  <script th:src="@{https://use.fontawesome.com/releases/v5.0.13/js/solid.js}" defer integrity="sha384-tzzSw1/Vo+0N5UhStP3bvwWPq+uvzCMfrN1fEFe+xBmv1C/AtVX5K0uZtmcHitFZ" crossorigin="anonymous"></script>
  <script th:src="@{https://use.fontawesome.com/releases/v5.0.13/js/fontawesome.js}" defer integrity="sha384-6OIrr52G08NpOFSZdxxz1xdNSndlD4vdcf/q2myIUVO0VsqaGHJsB0RaBE01VTOY" crossorigin="anonymous"></script>

  <!-- Para que el botón despliegue la barra lateral cuando la pantalla sea pequeña -->
  <script th:src="@{https://code.jquery.com/jquery-3.6.3.js}"></script>

  <title th:include=":: #pageTitle">Listeny</title>


</head>
<body>

<!-- Fragmento de la barra lateral de usuario -->
<aside id="sidebar" th:fragment="aside(favoritas)">
  <div class="card my-3 scroll-card">
    <a th:href="@{/home}" class="card" style="border: none;">
      <img th:src="@{/imagenes/logo.png}" class="card-img-top mx-auto my-3 w-50" alt="...">
    </a>

    <div class="list-group list-group-flush" style="border:0;">
      <a th:href="@{/perfil}" title="Perfil" class="list-group-item list-group-item-action d-flex justify-content-start align-items-center my-2 sidebar-item">
        <i class="fas fa-user fa-lg" style="margin-right: 35px;"></i>
        <h4 class="text-truncate" style="overflow: hidden;">PERFIL</h4>
      </a>
      <a th:href="@{/buscador}" title="Buscador" class="list-group-item list-group-item-action d-flex justify-content-start align-items-center my-2 sidebar-item">
        <i class="fas fa-search fa-lg" style="margin-right: 35px;"></i>
        <h4 class="text-truncate" style="overflow: hidden;">BUSCADOR</h4>
      </a>
      <a th:href="@{/canciones/misCanciones}" title="Subir canciones" class="list-group-item list-group-item-action d-flex justify-content-start align-items-center my-2 sidebar-item">
        <i class="fas fa-upload fa-lg" style="margin-right: 35px;"></i>
        <h4 class="text-truncate" style="overflow: hidden;">SUBIR CANCIONES</h4>
      </a>
      <div data-bs-toggle="modal" data-bs-target="#modal01" style="cursor: pointer;">
        <a title="Crear lista" class="list-group-item list-group-item-action d-flex justify-content-start align-items-center my-2 no-border sidebar-item">
          <i class="fas fa-list fa-lg" style="margin-right: 35px;" ></i>
          <h4 class="text-truncate" style="overflow: hidden;">CREAR LISTA</h4>
        </a>
      </div>

      <hr class="hr bg-black" style="border-top: 5px solid">

      <strong class="text-center"><a th:href="@{/canciones/favoritas}">ACCEDE A TU PLAYLIST DE CANCIONES FAVORITAS</a></strong>
      <div class="list-group list-group-flush scroll-independiente" th:each="favorita : ${favoritas}">
        <a title="Playlist 1" th:href="@{/lista/{id}(id=${favorita.id})}" class="list-group-item list-group-item-action d-flex justify-content-start align-items-center my-2 sidebar-item">
          <i class="fas fa-play-circle fa-lg" style="margin-right: 35px;"></i>
          <h5 class="text-truncate text-sm" th:text="${favorita.nombre}"></h5>
        </a>
      </div>
    </div>
  </div>
</aside>

<!-- Fragmento de la barra lateral de artista -->
<aside id="sidebar-artista" th:fragment="aside-artista(favoritas)">
  <div class="card my-3 scroll-card">
    <a th:href="@{/home}" class="card" style="border: none;">
      <img th:src="@{/imagenes/logo.png}" class="card-img-top mx-auto my-3 w-50" alt="...">
    </a>
      <div class="list-group list-group-flush" style="border: 0";>
        <a th:href="@{/perfil}" title="Perfil" class="list-group-item list-group-item-action d-flex justify-content-start align-items-center my-2 sidebar-item">
          <i class="fas fa-user fa-lg" style="margin-right: 35px;"></i>
          <h4 class="text-truncate" style="overflow: hidden;">PERFIL</h4>
        </a>
        <a th:href="@{/buscador}" title="Buscador" class="list-group-item list-group-item-action d-flex justify-content-start align-items-center my-2 sidebar-item">
          <i class="fas fa-search fa-lg" style="margin-right: 35px;"></i>
          <h4 class="text-truncate" style="overflow: hidden;">BUSCADOR</h4>
        </a>
        <a th:href="@{/canciones/misCanciones}" title="Subir canciones" class="list-group-item list-group-item-action d-flex justify-content-start align-items-center my-2 sidebar-item">
          <i class="fas fa-upload fa-lg" style="margin-right: 35px;"></i>
          <h4 class="text-truncate" style="overflow: hidden;">SUBIR CANCIONES</h4>
        </a>
        <div data-bs-toggle="modal" data-bs-target="#modal01" style="cursor: pointer;">
         <a title="Crear lista" class="list-group-item list-group-item-action d-flex justify-content-start align-items-center my-2 no-border sidebar-item">
           <i class="fas fa-list fa-lg" style="margin-right: 35px;" ></i>
           <h4 class="text-truncate" style="overflow: hidden;">CREAR LISTA</h4>
         </a>
        </div>
        <div th:if="${rol == '2'}" data-bs-toggle="modal" data-bs-target="#modal02" style="cursor: pointer;">
         <a title="Crear álbum" class="list-group-item list-group-item-action d-flex justify-content-start align-items-center my-2 mb-3 no-border sidebar-item">
           <i class="fas fa-compact-disc fa-lg" style="margin-right: 35px;"></i>
           <h4 class="text-truncate" style="overflow: hidden;">CREAR ÁLBUM</h4>
         </a>
        </div>

      <hr class="hr bg-black" style="border-top: 5px solid">

      <strong class="text-center"><a th:href="@{/canciones/favoritas}">ACCEDE A TU PLAYLIST DE CANCIONES FAVORITAS</a></strong>
        <div class="list-group list-group-flush scroll-independiente" th:each="favorita : ${favoritas}">
          <a title="Playlist 1" th:href="@{/lista/{id}(id=${favorita.id})}" class="list-group-item list-group-item-action d-flex justify-content-start align-items-center my-2 sidebar-item">
            <i class="fas fa-play-circle fa-lg" style="margin-right: 35px;"></i>
            <h5 class="text-truncate text-sm" th:text="${favorita.nombre}"></h5>
          </a>
        </div>
    </div>
  </div>
</aside>

<!-- Fragmento del reproductor -->
<div class="collapse" id="collapseExample" th:fragment="reproductor">
  <div class="col-12 player-container player-right">
    <div class="row">
      <div class="col-3 player-left">
        <img src="/imagenes/Pop_Latino.jpg" alt="Song image">
      </div>
      <div class="col-9 player-left">
        <p class="song-title">Nombre de la canción</p>
        <p class="artist-name">Nombre del artista</p>
      </div>
    </div>
    <audio controls style="width: 100%;">
      <source src="sample.mp3">
    </audio>
    <button class="btn-outline-secondary" type="button" style="float: left; margin-right: 10px; background-color: transparent; border:none;">
      <i id="megusta" class="bi bi-heart float-end fs-2" style="color: red; cursor:pointer;"></i>
    </button>
    <button class="btn btn-prev">
      <i class="fas fa-step-backward"></i>
    </button>
    <button class="btn btn-next">
      <i class="fas fa-step-forward"></i>
    </button>
    <button class="btn btn-random">
      <i class="fas fa-random"></i>
    </button>
    <div class="controls">
    </div>
  </div>
</div>



<!-- Fragmento con los scripts necesarios para todas las páginas -->
<section th:fragment="script">

  <!-- Optional JavaScript -->

  <script th:src="@{https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js}"
          integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3"
          crossorigin="anonymous"></script>
  <script th:src="@{https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js}"
          integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V"
          crossorigin="anonymous"></script>

  <script>
    $(document).ready(function(){
        $("#toggle-sidebar").click(function(){
        $("#sidebar").toggleClass("d-none");
        });
    });
  </script>

  <!-- Sirve para que cuando te posiciones encima del índice de cada canción de la playlist, este desaparezca y aparece el botón de play -->
  <script>
        $('.index').hover(function() {
        $(this).find('.index-number').hide();
        $(this).find('.fa-play').show();
        }, function() {
        $(this).find('.index-number').show();
        $(this).find('.fa-play').hide();
        });
  </script>

  <!-- Mostrar o no mostrar selección de categorías en función de la opción que elijas -->
  <script>
        function showCategory() {
        document.getElementById("category-container").style.display = "block";
        }

        function hideCategory() {
        document.getElementById("category-container").style.display = "none";
        }
  </script>

  <!-- Para rellenar el icono del corazón al hacer click (para seguir a usuario) -->
  <script>
      $(".bi-heart").click(function (e) {
        var elem = document.getElementById(e.currentTarget.dataset.id);
        var tipo = document.getElementById(e.currentTarget.dataset.tipo);

        document.getElementById(e.id).classList.toggle("bi-heart");
        document.getElementById(e.id).classList.toggle("bi-heart-fill");
        if (elem.classList.contains('bi-heart')) {
          url = '/nomegusta'
        } else {
          url = "/megusta"
        }
        $.ajax({
          url: url,
          data: {
            id: elem,
            tipo: tipo
          },
          dataType: 'json'
        })
      })
  </script>

  <!-- Para que las playlists de la barra lateral tengan su propio scroll -->
  <script>
      const element = document.querySelector('.scroll-independiente');
      element.style.overflowY = 'scroll';
      element.style.maxHeight = '170px';
  </script>


</section>


</body>
</html>